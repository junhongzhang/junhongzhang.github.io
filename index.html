<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="一个挖矿工人到数据民工的成长历程">
<meta name="keywords" content="数据分析、机器学习、职场、个人品牌">
<meta property="og:type" content="website">
<meta property="og:title" content="张俊红的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="张俊红的博客">
<meta property="og:description" content="一个挖矿工人到数据民工的成长历程">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="张俊红的博客">
<meta name="twitter:description" content="一个挖矿工人到数据民工的成长历程">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>张俊红的博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">张俊红的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            日程表
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/12/Sklearn参数详解--决策树/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张俊红">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/7602070dly1fqcbzsq7j6j20qo0qoacs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张俊红的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/12/Sklearn参数详解--决策树/" itemprop="url">Sklearn参数详解——决策树</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-12T11:10:30+08:00">
                2018-05-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<p><img src="https://ws1.sinaimg.cn/large/006JdmJily1fr8d4lilolj30qw0evmy6.jpg" alt=""></p>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>先来简短的回顾一下决策树原理：</p>
<p>决策树学习的算法通常是一个递归地（根据某一准则，信息增益或基尼系数）选择最优切分点/特征，并根据该特征对训练数据集进行分割，使得对各个子数据集有一个最好的分类过程，这一过程对应着对特征空间的划分，也对应着决策树的构建，继续在子数据集上循环这个切割的过程，直到所有的训练数据子集被基本正确分类，或者没有合适的特征为止。</p>
<p>你也可以看这里：</p>
<p><a href="http://suo.im/4HragT" target="_blank" rel="noopener">决策树详解(一)</a><br><a href="http://suo.im/5imgz6" target="_blank" rel="noopener">决策树详解(二)</a></p>
<h3 id="参数详解"><a href="#参数详解" class="headerlink" title="参数详解"></a>参数详解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sklearn.tree.DecisionTreeClassifier</span><br><span class="line">        (criterion=<span class="string">'gini'</span>, splitter=<span class="string">'best'</span>, max_depth=<span class="keyword">None</span>, min_samples_split=<span class="number">2</span>, </span><br><span class="line">        min_samples_leaf=<span class="number">1</span>,min_weight_fraction_leaf=<span class="number">0.0</span>, max_features=<span class="keyword">None</span>, </span><br><span class="line">        random_state=<span class="keyword">None</span>, max_leaf_nodes=<span class="keyword">None</span>, min_impurity_decrease=<span class="number">0.0</span>, </span><br><span class="line">        min_impurity_split=<span class="keyword">None</span>, class_weight=<span class="keyword">None</span>, presort=<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
<p><code>criterion</code>:特征选择的标准，有信息增益和基尼系数两种，使用信息增益的是ID3和C4.5算法（使用信息增益比），使用基尼系数的CART算法，默认是gini系数。</p>
<p><code>splitter</code>:特征切分点选择标准，决策树是递归地选择最优切分点，spliter是用来指明在哪个集合上来递归，有“best”和“random”两种参数可以选择，best表示在所有特征上递归，适用于数据集较小的时候，random表示随机选择一部分特征进行递归，适用于数据集较大的时候。</p>
<p><code>max_depth</code>:决策树最大深度，决策树模型先对所有数据集进行切分，再在子数据集上继续循环这个切分过程，max_depth可以理解成用来限制这个循环次数。</p>
<p><code>min_samples_split</code>:子数据集再切分需要的最小样本量，默认是2，如果子数据样本量小于2时，则不再进行下一步切分。如果数据量较小，使用默认值就可，如果数据量较大，为降低计算量，应该把这个值增大，即限制子数据集的切分次数。</p>
<p><code>min_samples_leaf</code>:叶节点（子数据集）最小样本数，如果子数据集中的样本数小于这个值，那么该叶节点和其兄弟节点都会被剪枝（去掉），该值默认为1。</p>
<p><code>min_weight_fraction_leaf</code>:在叶节点处的所有输入样本权重总和的最小加权分数，如果不输入则表示所有的叶节点的权重是一致的。</p>
<p><code>max_features</code>:特征切分时考虑的最大特征数量，默认是对所有特征进行切分，也可以传入int类型的值，表示具体的特征个数；也可以是浮点数，则表示特征个数的百分比；还可以是sqrt,表示总特征数的平方根；也可以是log2，表示总特征数的log个特征。</p>
<p><code>random_state</code>:随机种子的设置，与LR中参数一致。</p>
<p><code>max_leaf_nodes</code>:最大叶节点个数，即数据集切分成子数据集的最大个数。</p>
<p><code>min_impurity_decrease</code>:切分点不纯度最小减少程度，如果某个结点的不纯度减少小于这个值，那么该切分点就会被移除。</p>
<p><code>min_impurity_split</code>:切分点最小不纯度，用来限制数据集的继续切分（决策树的生成），如果某个节点的不纯度（可以理解为分类错误率）小于这个阈值，那么该点的数据将不再进行切分。</p>
<p><code>class_weight</code>:权重设置，主要是用于处理不平衡样本，与LR模型中的参数一致，可以自定义类别权重，也可以直接使用balanced参数值进行不平衡样本处理。</p>
<p><code>presort</code>:是否进行预排序，默认是False，所谓预排序就是提前对特征进行排序，我们知道，决策树分割数据集的依据是，优先按照信息增益/基尼系数大的特征来进行分割的，涉及的大小就需要比较，如果不进行预排序，则会在每次分割的时候需要重新把所有特征进行计算比较一次，如果进行了预排序以后，则每次分割的时候，只需要拿排名靠前的特征就可以了。</p>
<h3 id="对象-属性"><a href="#对象-属性" class="headerlink" title="对象/属性"></a>对象/属性</h3><p><code>classes_</code>:分类模型的类别，以字典的形式输出<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">clf.classes_</span><br><span class="line">---------------</span><br><span class="line">array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])<span class="comment">#表示0，1，2类别</span></span><br></pre></td></tr></table></figure></p>
<p><code>feature_importances_</code>:特征重要性，以列表的形式输出每个特征的重要性<br><code>max_features_</code>:最大特征数<br><code>n_classes_</code>:类别数，与classes_对应，classes_输出具体的类别<br><code>n_features_</code>:特征数，当数据量小时，一般max_features和n_features_相等<br><code>n_outputs_</code>:输出结果数<br><code>tree_</code>:输出整个决策树,用于生成决策树的可视化<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">clf.tree_</span><br><span class="line">---------</span><br><span class="line">&lt;sklearn.tree._tree.Tree at <span class="number">0x241c20e5d30</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p>最终生成的可视化就是下面这个样子。<br><img src="https://ws1.sinaimg.cn/large/006JdmJily1fr8cvun7tqj30ug0nmwgj.jpg" alt="图注:决策树可视化结果"></p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p><code>decision_path(X)</code>:返回X的决策路径<br><code>fit(X, y)</code>:在数据集(X,y)上使用决策树模型<br><code>get_params([deep])</code>:获取模型的参数<br><code>predict(X)</code>:预测数据值X的标签<br><code>predict_log_proba(X)</code>:返回每个类别的概率值的对数<br><code>predict_proba(X)</code>:返回每个类别的概率值（有几类就返回几列值）<br><code>score(X,y)</code>:返回给定测试集和对应标签的平均准确率</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/28/Python面向对象编程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张俊红">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/7602070dly1fqcbzsq7j6j20qo0qoacs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张俊红的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/28/Python面向对象编程/" itemprop="url">Python面向对象编程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-28T00:57:54+08:00">
                2018-04-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python编程/" itemprop="url" rel="index">
                    <span itemprop="name">python编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>应后台读者要求，所以有了这篇文章。</p>
<p><img src="https://ws1.sinaimg.cn/large/006JdmJily1fqrp097eujj30cm04rgls.jpg" alt="图注:后台读者留言"></p>
<p>在开始介绍具体的面向对象编程以前，先介绍一下另一个概念:[面向过程编程]。</p>
<blockquote>
<p>面向<strong>过程</strong>编程，重点在于过程(可以理解成how)，即以过程为核心，计算机/写代码的人会把精力聚焦在具体的实现过程上，这个过程第一步干什么，第二步干什么，直到最后完成了你的目标。<br>面向<strong>对象</strong>编程，重点在于对象(可以理解成who)，即以对象为核心，这个对象有什么技能(不止一个技能的)，这个对象所拥有的哪些技能够帮你实现你的目标。<br><strong>前者比较关注怎么做，后者比较关注谁来做。</strong></p>
</blockquote>
<p>来看张图片：<br><img src="https://ws1.sinaimg.cn/large/006JdmJily1fqi93tu56oj30q20hi76t.jpg" alt="图注:知乎大佬的解释"></p>
<h3 id="面向对象的基本概念"><a href="#面向对象的基本概念" class="headerlink" title="面向对象的基本概念"></a>面向对象的基本概念</h3><p>了解了面向过程和面向对象编程的基本思想以后，我们来介绍面向对象编程中一些基本概念。</p>
<p><code>类(Class)</code>: 用来描述具有<strong>相同的属性和方法</strong>的<strong>对象的集合</strong>。其实类的本意就是类别，表示同类别事物（对象）的一个组合，比如说从事数据分析这个岗位的这些人就是一个类，他们有共同的属性(数据分析师&amp;喜欢用数据说话)和共同的方法/技能（写sql、操作excel、写脚本）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#通过class关键词来创建一个类</span></span><br><span class="line"><span class="comment">#定义了名为“data_analyst”(数据分析)的一个类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">data_analyst</span>:</span></span><br><span class="line">    name = <span class="string">"数据分析师"</span></span><br><span class="line">    feature = <span class="string">"喜欢用数据说话"</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sql</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"正在导数据"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">excel</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"正在做表"</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">python</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"正在写脚本"</span>)</span><br></pre></td></tr></table></figure>
<p><code>类属性</code>:就是对类的属性做一些设定，比如名字、特征之类的，上面代码中的<code>name</code>和<code>feature</code>就是类data_analyst的属性。</p>
<p><code>类方法</code>:就是类的一些技能，用<code>def</code>来指定，和定义函数有点类似(注意是类似，还是有些不同的，后面讲)，也可以理解成类的对象所拥有的技能。</p>
<p><code>对象</code>:就是类中的具体一个事物，是关于类而实际存在的一个例子，即实例。比如说众多数据分析师中的小明，就是类data_analyst的一个对象。而小明这个对象具有类data_analyst的所有属性和方法/技能。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xiaoming = data_analyst()</span><br><span class="line">xiaoming.name</span><br><span class="line">----------</span><br><span class="line"><span class="string">"数据分析师"</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xiaoming.sql()</span><br><span class="line">---------</span><br><span class="line">正在导数据</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xiaoming.excel()</span><br><span class="line">---------</span><br><span class="line">正在做表</span><br></pre></td></tr></table></figure>
<p><code>实例化</code>:实例化的过程就是类到对象的过程，实例其实就是<strong>创建</strong>一个实际例子，类的具体对象。</p>
<p><code>__init__</code>:init是初始化的意思，用在实例化的过程中，当对类进行实例化时（创建一个新的实例），类会自动调用该函数。上面只是创建了小明一个实例，我们再来多创建几个其他的数据分析师（怎么感觉有点不对劲），比如小张、小李。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">data_analyst</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,name,skill)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.skill = skill</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">working</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.name == xiaozhang:</span><br><span class="line">            print(<span class="string">"小张正在写：&#123;&#125;"</span>.format(self.skill))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"小李正在写：&#123;&#125;"</span>.format(self.skill))</span><br><span class="line"></span><br><span class="line">xiaozhang=data_analyst(<span class="string">"xiaozhang"</span>,<span class="string">"sql"</span>) <span class="comment">#创建xiaozhang</span></span><br><span class="line">print(<span class="string">"小张的名字是：&#123;&#125;"</span>.format(xiaozhang.name))</span><br><span class="line">print(<span class="string">"小张的技能是：&#123;&#125;"</span>.format(xiaozhang.skill))</span><br><span class="line">print(xiaozhang.working())  <span class="comment">#调用类的working方法</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"---------------------"</span>)</span><br><span class="line"></span><br><span class="line">xiaoli=data_analyst(<span class="string">"xiaoli"</span>,<span class="string">"python"</span>) <span class="comment">#创建xiaoli</span></span><br><span class="line">print(<span class="string">"小李的名字是：&#123;&#125;"</span>.format(xiaoli.name))</span><br><span class="line">print(<span class="string">"小李的技能是：&#123;&#125;"</span>.format(xiaoli.skill))</span><br><span class="line">print(xiaoli.working()) <span class="comment">#调用类的working方法</span></span><br><span class="line"></span><br><span class="line">---------------------</span><br><span class="line">小张的名字是：xiaozhang</span><br><span class="line">小张的技能是：sql</span><br><span class="line">小张正在写：sql</span><br><span class="line">---------------------</span><br><span class="line">小李的名字是：xiaoli</span><br><span class="line">小李的技能是：python</span><br><span class="line">小李正在写：python</span><br></pre></td></tr></table></figure></p>
<p><code>self</code>:self是<strong>init</strong>和def方法中的默认的第一个参数，表明实例本身，可以省略不写。这就是类方法和普通函数的一点不同之处。</p>
<p>把上面的基本概念总结一下，就是把具有相同属性和方法的对象聚成一个类，然后在这个类里面去声明一些属性、定义一些方法，最后通过实例化创造几个实例/对象，通过实例化创建的对象就可以去引用类中的每个属性和调用类中的每个方法。</p>
<h3 id="面向对象的编程的好处"><a href="#面向对象的编程的好处" class="headerlink" title="面向对象的编程的好处"></a>面向对象的编程的好处</h3><p>前面我们介绍了面向过程的面向对象的基本思想，也介绍了面向对象中的一些基本概念，接下来我们再看看面向对象有什么特别的优点，只有这样意识到做一件事事情的好处，我们才更愿意走出舒适区（毕竟我们已经习惯了面向过程编程的思维），去接受这个新的东西。通过下面这个实例，我们来看一下编程的几个不同发展阶段。</p>
<p>已知每个学生各科分数，求取每个学生的总分，平均分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">student_1=[<span class="number">80</span>,<span class="number">60</span>,<span class="number">75</span>,<span class="number">90</span>]</span><br><span class="line">student_2=[<span class="number">70</span>,<span class="number">80</span>,<span class="number">65</span>,<span class="number">85</span>]</span><br><span class="line">student_3=[<span class="number">70</span>,<span class="number">75</span>,<span class="number">90</span>,<span class="number">80</span>]</span><br></pre></td></tr></table></figure>
<p><strong>最开始</strong>的时候我们是这样做的:</p>
<p>先求取student_1的分数情况,<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">student_1_sum=(student_1[<span class="number">0</span>]+student_1[<span class="number">1</span>]+student_1[<span class="number">2</span>]+student_1[<span class="number">3</span>])</span><br><span class="line">student_1_mean=(student_1[<span class="number">0</span>]+student_1[<span class="number">1</span>]+student_1[<span class="number">2</span>]+student_1[<span class="number">3</span>])/<span class="number">4</span></span><br></pre></td></tr></table></figure></p>
<p>要求student_2和student_3的分数情况，我们可以把student_1的代码复制过来，改一下student就可以。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">student_2_sum=(student_2[<span class="number">0</span>]+student_2[<span class="number">1</span>]+student_2[<span class="number">2</span>]+student_2[<span class="number">3</span>])</span><br><span class="line">student_2_mean=(student_2[<span class="number">0</span>]+student_2[<span class="number">1</span>]+student_2[<span class="number">2</span>]+student_2[<span class="number">3</span>])/<span class="number">4</span></span><br><span class="line"></span><br><span class="line">student_3_sum=(student_3[<span class="number">0</span>]+student_3[<span class="number">1</span>]+student_3[<span class="number">2</span>]+student_1[<span class="number">3</span>])</span><br><span class="line">student_3_mean=(student_3[<span class="number">0</span>]+student_3[<span class="number">1</span>]+student_3[<span class="number">2</span>]+student_1[<span class="number">3</span>])/<span class="number">4</span></span><br></pre></td></tr></table></figure>
<p><strong>后来</strong>大家发现上面的代码有点冗余，不仅看起来难受，更重要的编写耗费时间也很长，又得让程序员gg多加班两小时，所以聪明的（爱偷懒的）技术大牛就发明了函数这种东西，具体执行如下:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">先定义求和以及求均值的函数，然后让每个学生分别去调用这两个函数即可。</span><br><span class="line"><span class="comment">#定义求和函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span><span class="params">(student)</span>:</span></span><br><span class="line">    student_sum=(student[<span class="number">0</span>]+student[<span class="number">1</span>]+student[<span class="number">2</span>]+student[<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">return</span> student_sum</span><br><span class="line"></span><br><span class="line"><span class="comment">#定义求均值函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mean</span><span class="params">(student)</span>:</span></span><br><span class="line">    student_mean=(student[<span class="number">0</span>]+student[<span class="number">1</span>]+student[<span class="number">2</span>]+student[<span class="number">3</span>])/<span class="number">4</span></span><br><span class="line">    <span class="keyword">return</span> student_mean</span><br><span class="line"></span><br><span class="line"><span class="comment">#求取student_1的总分和均值</span></span><br><span class="line">student_1_sum=sum(student_1) <span class="comment">#调用sum函数求总分</span></span><br><span class="line">student_1_mean=mean(student_1) <span class="comment">#调用mean函数求均值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#求取student_2的总分和均值</span></span><br><span class="line">student_2_sum=sum(student_2)</span><br><span class="line">student_2_mean=mean(student_2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#求取student_3的总分和均值</span></span><br><span class="line">student_3_sum=sum(student_3)</span><br><span class="line">student_3_mean=mean(student_3)</span><br></pre></td></tr></table></figure></p>
<p><strong>再后来</strong>，善于琢磨的程序员gg经过不懈的努力，终于又研究出更加简洁的一种方法，那些无数个加班夜总算没有白加，于是乎就有了本章的内容:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建一个类，因为所有学生的方法</span></span><br><span class="line"><span class="comment">#都是一样的(求和以及求均值的的方法是一致的)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sum</span><span class="params">(self,student)</span>:</span></span><br><span class="line">        student_sum=(student[<span class="number">0</span>]+student[<span class="number">1</span>]+student[<span class="number">2</span>]+student[<span class="number">3</span>])</span><br><span class="line">        print(student_sum)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mean</span><span class="params">(self,student)</span>:</span></span><br><span class="line">        student_mean=(student[<span class="number">0</span>]+student[<span class="number">1</span>]+student[<span class="number">2</span>]+student[<span class="number">3</span>])/<span class="number">4</span></span><br><span class="line">        print(student_mean)</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建student_score对象</span></span><br><span class="line">student_score=student()</span><br><span class="line"></span><br><span class="line"><span class="comment">#求取student_1的总分和均值</span></span><br><span class="line">student_1_sum=student_score.sum(student_1) <span class="comment">#引用student类的sum方法</span></span><br><span class="line">student_1_mean=student_score.mean(student_1) <span class="comment">#引用student类的mean方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#求取student_2的总分和均值</span></span><br><span class="line">student_2_sum=student_score.sum(student_2)</span><br><span class="line">student_2_mean=student_score.mean(student_2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#求取student_3的总分和均值</span></span><br><span class="line">student_3_sum=student_score.sum(student_3)</span><br><span class="line">student_3_mean=student_score.mean(student_3)</span><br></pre></td></tr></table></figure></p>
<h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><p>关于面向对象的知识点还有很多，我们本章节就主要讲这么多，让大家对面向对象有个基本认识，能够日常使用就ok，更加深层次的知识还需要大家自行去探索。</p>
<p>在写本章的时候主要参考了以下几个链接：<br><a href="https://www.zhihu.com/question/27468564" target="_blank" rel="noopener">https://www.zhihu.com/question/27468564</a><br><a href="https://www.zhihu.com/question/19729316" target="_blank" rel="noopener">https://www.zhihu.com/question/19729316</a><br><a href="http://www.cnblogs.com/wupeiqi/p/4493506.html" target="_blank" rel="noopener">http://www.cnblogs.com/wupeiqi/p/4493506.html</a>   <a href="http://www.cnblogs.com/wupeiqi/p/4766801.html" target="_blank" rel="noopener">http://www.cnblogs.com/wupeiqi/p/4766801.html</a><br>感谢各位大佬。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/16/Sklearn参数详解—LR模型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张俊红">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/7602070dly1fqcbzsq7j6j20qo0qoacs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张俊红的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/16/Sklearn参数详解—LR模型/" itemprop="url">Sklearn参数详解——LR模型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-16T23:12:00+08:00">
                2018-04-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近会开始一个新的系列，sklearn库中各模型的参数解释，本篇主要讲述最基础的LR模型。</p>
<h3 id="模型参数详解"><a href="#模型参数详解" class="headerlink" title="模型参数详解"></a>模型参数详解</h3><p>逻辑回归：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.linear_model.LogisticRegression(penalty=&apos;l2&apos;, dual=False, tol=0.0001, C=1.0, fit_intercept=True, intercept_scaling=1, class_weight=None, random_state=None, solver=&apos;liblinear&apos;, max_iter=100, multi_class=&apos;ovr&apos;, verbose=0, warm_start=False, n_jobs=1)</span><br></pre></td></tr></table></figure></p>
<p><code>penalty</code>:正则化选择参数，参数可选值为l1和l2，分别对应l1正则化和l2正则化，默认是l2正则化。</p>
<p>调整该参数的目的主要是为了防止过拟合，一般penalty选择l2正则化就够啦，但是如果选择l2正则化发现依然过拟合，即预测效果还是很差的时候，就可以考虑l1正则化。如果模型的特征非常多，我们希望做一些特征选择（即把一些不重要的特征过滤掉），这个时候也可以考虑用l1正则化。</p>
<p>penalty参数的选择会影响我们损失函数优化算法的选择，即参数<code>solver</code>的选择，如果是l2正则化，可选的优化算法 {‘newton-cg’, ‘lbfgs’, ‘liblinear’, ‘sag’}都可以选择。但是如果penalty是L1正则化的话，就只能选择‘liblinear’了。这是因为L1正则化的损失函数不是连续可导的，而{‘newton-cg’, ‘lbfgs’,‘sag’}这三种优化算法时都需要损失函数的一阶或者二阶连续导数。而‘liblinear’并没有这个依赖。这几个优化方法在solver参数环节进行讲述。</p>
<p><code>dual</code>:用来指明是否将原问题改成他的对偶问题，对偶问题可以理解成相反问题，比如原问题是求解最大值的线性规划，那么他的对偶问题就是转化为求解最小值的线性规划，适用于样本较小的数据集，因样本小时，计算复杂度较低。</p>
<p><code>tol</code>:残差收敛条件，默认是0.0001，也就是只需要收敛的时候两步只差＜0.0001就停止，可以设置更大或更小。(逻辑回归模型的损失函数是残差平方和)</p>
<p><code>C</code>:正则化系数，正则化强度的导数，必须是一个正数，值越小，正则化强度越大，即防止过拟合的程度更大。</p>
<p><code>fit_intercept</code>:是否将截距/方差加入到决策模型中，默认为True。</p>
<p><code>class_weight</code>:class_weight是很重要的一个参数，是用来调节正负样本比例的，默认是值为None，也就是正负样本的权重是一样的，你可以以dict的形式给模型传入任意你认为合适的权重比，也可以直接指定一个值“balanced”，模型会根据正负样本的绝对数量比来设定模型最后结果的权重比。</p>
<p>比如，有一数据集的正负样本绝对数量比为4:6,如果你给参数class_weight赋予balanced值，那么最后模型结果中，正负样本的权重比就会变成6:4。</p>
<p><code>random_state</code>:随机种子的设置，默认是None,如果设置了随机种子，那么每次使用的训练集和测试集都是一样的，这样不管你运行多少次，最后的准确率都是一样的；如果没有设置，那么每次都是不同的训练集和测试集，最后得出的准确率也是不一样的。</p>
<p><code>solver</code>:用来指明损失函数的优化方法，默认是‘liblinear’方法，sklearn自带了如下几种：</p>
<table>
<thead>
<tr>
<th>参数值</th>
<th>优化方法</th>
</tr>
</thead>
<tbody>
<tr>
<td>liblinear</td>
<td>使用了坐标轴下降法来迭代优化损失函数</td>
</tr>
<tr>
<td>lbfgs</td>
<td>拟牛顿法的一种，利用损失函数二阶导数矩阵即海森矩阵来迭代优化损失函数</td>
</tr>
<tr>
<td>newton-cg</td>
<td>也是牛顿法法的一种，利用损失函数二阶导数矩阵即海森矩阵来迭代优化损失函数</td>
</tr>
<tr>
<td>sag</td>
<td>即随机平均梯度下降，是梯度下降法的变种，是一种线性收敛算法，和普通梯度下降法的区别是每次迭代仅仅用一部分的样本来计算梯度，适合于样本数据多的时候</td>
</tr>
</tbody>
</table>
<p>newton-cg, lbfgs和sag这三种优化算法时都需要损失函数的一阶或者二阶连续导数，因此不能用于没有连续导数的L1正则化，只能用于L2正则化。而liblinear对L1正则化和L2正则化都适用。同时，因sag每次仅仅使用了部分样本进行梯度迭代，所以当数据量较少时不宜选用，而当数据量很大时，为了速度，sag是第一选择。</p>
<p><code>max_iter</code>:算法收敛的最大迭代次数，即求取损失函数最小值的迭代次数，默认是100，<br><code>multi_class</code>:分类方法参数选择，‘ovr’和‘multinomial’两个值可以选择，默认值为‘ovr’，如果分类问题是二分类问题，那么这两个参数的效果是一样的，主要体现在多分类问题上。</p>
<p>对于多分类问题，”ovr”分类方法是：针对每一类别进行判断时，都会把这个分类问题简化为是/非两类问题；而‘multinomial’是从众多类别中选出两个类别，对这两个类别进行判断，待判断完成后，再从剩下的类别中再选出两类进行判断，直至最后判断完成。</p>
<p><code>verbose</code>:英文意思是”冗余“，就是会输出一些模型运算过程中的东西（任务进程），默认是False，也就是不需要输出一些不重要的计算过程。</p>
<p><code>warm_start</code>:是否使用上次的模型结果作为初始化，默认是False，表示不使用。</p>
<p><code>n_jobs</code>:并行运算数量(核的数量)，默认为1，如果设置为-1，则表示将电脑的cpu全部用上。</p>
<h3 id="模型对象"><a href="#模型对象" class="headerlink" title="模型对象"></a>模型对象</h3><blockquote>
<p><code>coef_</code>:返回各特征的系数,绝对值大小可以理解成特征重要性<br><code>intercept_</code>:返回模型的截距<br><code>n_iter_</code>:模型迭代次数</p>
</blockquote>
<h3 id="模型方法"><a href="#模型方法" class="headerlink" title="模型方法"></a>模型方法</h3><blockquote>
<p><code>decision_function(X)</code>:返回决策函数值（比如svm中的决策距离）<br><code>predict_proba(X)</code>:返回每个类别的概率值（有几类就返回几列值）<br><code>predict_log_proba(X)</code>:返回概率值的log值（即将概率取对数）<br><code>predict(X)</code>：返回预测结果值（0/1）<br><code>score(X, y=None)</code>:返回函数<br><code>get_params(deep=True)</code>:返回估计器的参数<br><code>set_params(**params)</code>:为估计器设置参数</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/14/实战-用户价值模型搭建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张俊红">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws1.sinaimg.cn/large/7602070dly1fqcbzsq7j6j20qo0qoacs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张俊红的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/14/实战-用户价值模型搭建/" itemprop="url">实战-用户价值模型搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-14T17:45:53+08:00">
                2018-04-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据分析/" itemprop="url" rel="index">
                    <span itemprop="name">数据分析</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近在做一个用户评分模型的项目，这个模型的目的就是用来判断用户的价值。希望通过各种指标来给用户综合打分，每个用户最后会得到一个分值，分值越高，说明用户的价值越高。这是一个总的目标，一个用户可以创造的价值由两部分决定：创造价值的能力和创造价值的意愿，前者是能不能的问题、后者是愿不愿意的问题。定了两个主线以后再次进行目标拆解，根据业务经验分别找到那些能够判断用户创造价值的能力和意愿的指标，然后给不同的指标赋予不同的权重/分值，最后将各指标的权重/分值相加就是用户最后的总得分。</p>
<p>上面的这个过程有两个关键步骤，一个是<strong>选择合适的指标</strong>，另一个是<strong>给不同的指标赋予不同的权重</strong>，关于指标的选取，这个根据业务经验直接拍脑袋就可以，但是这个不同指标的权重问题，可能直接拍脑袋就不是太好了，当然了，也不是不可以。不过，做数据是一个严谨的工作（咳咳咳），还是希望能够找到一套理论来代替拍脑袋，所以就在网上找啊找，终于找到了今天的主角，就是AHP。</p>
<h3 id="AHP介绍"><a href="#AHP介绍" class="headerlink" title="AHP介绍"></a>AHP介绍</h3><p>先来看看比较官方的解释：</p>
<blockquote>
<p>AHP(Analytic Hierarchy Process-解析阶层的过程)又叫层次分析法，是一种定性与定量相结合的分析方法，是一种将决策者对复杂系统的决策思维过程模型化、数量化的过程。</p>
</blockquote>
<p>是不是有点看不太明白，我来说几句大白话让你理解理解。让我们与前言里面的内容对应一下，AHP其实就是一种<strong>把复杂问题</strong>通过定性（人为去判断各指标之间的重要性）与定量（再通过计算判断矩阵求出各指标权重）的方法进行<strong>拆解成若干个小问题以及小指标的问题，并能够计算出各个小问题以及小指标对整个大目标的影响程度。</strong><br><img src="https://ws1.sinaimg.cn/large/7602070dly1fqcabg8gc3j20vk08e3ys.jpg" alt="image"><br>来看张图，你就更清楚了，这张图正好可以表达我在前言里面说到的东西。我们的最终目标就是要确定每个用户的一个用户价值，那么我们可以把这个目标进行拆解，首次拆解成购买忠诚度和消费能力这两个小问题，进而再对这两个小问题进行拆解，分别得到下面的各个指标，这其实就是一个定性的过程（问题拆解，指标拆解都是需要我们依据业务经验，人为去指定），至于各问题和各指标的权重计算就是一个定量过程,其实<strong>AHP主要是做定量这一部分。</strong></p>
<h3 id="AHP流程"><a href="#AHP流程" class="headerlink" title="AHP流程"></a>AHP流程</h3><p>知道了AHP是什么以后，我们来具体看看AHP的一个具体流程。</p>
<ul>
<li>明确问题</li>
<li>问题及指标拆解</li>
<li>建立指标两两判断矩阵</li>
<li>层次单排序</li>
<li>层次总排序</li>
</ul>
<h4 id="明确问题"><a href="#明确问题" class="headerlink" title="明确问题"></a>明确问题</h4><p>就是首先你要确定你要解决什么问题，我们这里就是要构建用户价值模型，希望通过这个模型看出每个用户的一个价值，然后依据价值不同给与不同的运营策略。</p>
<h4 id="问题及指标拆解"><a href="#问题及指标拆解" class="headerlink" title="问题及指标拆解"></a>问题及指标拆解</h4><p>将搭建用户价值模型这个总目标拆解成用户购买忠诚度以及用户消费能力两部分，然后再对这两部分进行指标拆解，就是上面图表中看到的各指标。</p>
<h4 id="构造判断矩阵"><a href="#构造判断矩阵" class="headerlink" title="构造判断矩阵"></a>构造判断矩阵</h4><p>所谓的判断矩阵就是将任意两指标进行对比得出一个重要性结果，然后将这个结果以矩阵的形式进行呈现，其中重要程度差别等级如下：</p>
<table>
<thead>
<tr>
<th>标度</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>表示两个指标相比，具有同样的重要性</td>
</tr>
<tr>
<td>3</td>
<td>表示两个指标相比，前者比后者稍重要</td>
</tr>
<tr>
<td>5</td>
<td>表示两个指标相比，前者比后者明显重要</td>
</tr>
<tr>
<td>7</td>
<td>表示两个指标相比，前者比后者极其重要</td>
</tr>
<tr>
<td>9</td>
<td>表示两个指标相比，前者比后者强烈重要</td>
</tr>
<tr>
<td>2,4,6,8</td>
<td>表示上述两指标判断结果的中间值，比如2是介于1和3之间的</td>
</tr>
</tbody>
</table>
<p>数值越大，表示前者比后者越重要;指标A和指标B判断结果与指标B与指标A和指标B判断结果互为倒数，即当指标A比指标B的重要程度是3的时候，那么指标B比指标A的重要程度就是3的倒数，即1/3。</p>
<p>不知道你有没有注意到，其实上面的这种方法也有一定的主观判断（拍脑袋），比如两指标之间的稍微重要，明显重要，极其重要也是需要你人为去指定的，你可能会疑问，既然都是拍脑袋，那还要这个干啥，直接拍脑袋不久得了，还搞这么复杂干嘛，哈哈哈，关于好处接下来会讲到。</p>
<p>判断矩阵A构造出来了，我们就可以开始计算各指标对目标问题的影响程度（即各指标的权重值）。</p>
<h4 id="各指标权重计算步骤"><a href="#各指标权重计算步骤" class="headerlink" title="各指标权重计算步骤"></a>各指标权重计算步骤</h4><ul>
<li>将矩阵A的每一列向量归一化</li>
<li>对归一化后的矩阵按行求和，得到一列值</li>
<li>对上述求和的一列值再次进行归一化得到矩阵w</li>
<li>计算最大特征根<br><img src="https://ws1.sinaimg.cn/large/7602070dly1fqcagot3vqj20pm0h6405.jpg" alt="image"><br>注意：这里的归一化只是把每一列的值的和当作1，然后计算每一个值在1中的占比。</li>
</ul>
<p>上述步骤中归一化后得到的矩阵w就是各个指标的权重情况，这个权重是根据我们主观上构造的判断矩阵的出来的，但是这个权重是否准确，还是有待确定的，为什么要去确定呢，因为判断矩阵很有可能得出的相互矛盾的结论，比如<strong>说A指标重要性大于B指标，B指标重要性大于C指标，但是A指标重要性又小于C指标重要性，这种互相矛盾的结论。</strong>AHP就可以避免这种矛盾的发生。这里需要引入AHP中的另一个概念<code>一致性检验</code>，用来判断矩阵是否一致。</p>
<h4 id="一致性检验的步骤如下"><a href="#一致性检验的步骤如下" class="headerlink" title="一致性检验的步骤如下"></a>一致性检验的步骤如下</h4><ul>
<li>根据判断矩阵计算最大特征根</li>
<li>计算一致性指标CI</li>
<li>根据n的值(指标的数量)找出随机一致性指标RI</li>
<li>计算一致性比率<code>CR=CI/RI</code>,当CR&lt;0.1时，不一致性程度在容许范围内，即各指标的重要性程度不存在上述互相矛盾的情况，可以使用。</li>
</ul>
<p><img src="https://ws1.sinaimg.cn/large/7602070dly1fqcahe0mxvj20pp0gh761.jpg" alt="image"></p>
<p>如果一致性比率符合使用条件，则可以直接使用计算出的各指标的权重值，如果不符合，则需要重新构造判断矩阵。</p>
<h4 id="层次单排序"><a href="#层次单排序" class="headerlink" title="层次单排序"></a>层次单排序</h4><p>就是对单一层次计算权重情况，比如用户价值模型总目标的下一层就是用户忠诚程度和用户消费能力的权重情况。<code>用户忠诚程度:用户消费能力=0.67:0.33</code>。而用户忠诚程度和用户消费能力的下一层就是各个更加细致的指标。</p>
<p>#5.层次总排序<br>层次总排序就是将各个层次的权重值相乘，最后就得到了各个指标的权重情况，就是层次总排序。</p>
<h3 id="AHP实例"><a href="#AHP实例" class="headerlink" title="AHP实例"></a>AHP实例</h3><p>还是以前面说到用户价值模型为例，走一遍完整的流程。这里我们计算用户忠诚度的AHP，因为只有三个指标及以上才会出现那种互相矛盾的情况，两个指标是不会出现的，两个指标的话直接人为指定权重占比就可以。</p>
<h4 id="构造判断矩阵-1"><a href="#构造判断矩阵-1" class="headerlink" title="构造判断矩阵"></a>构造判断矩阵</h4><table>
<thead>
<tr>
<th></th>
<th>最近购买间隔</th>
<th>购买频率</th>
<th>购买商品种类</th>
</tr>
</thead>
<tbody>
<tr>
<td>最近购买间隔</td>
<td>1</td>
<td>1/6</td>
<td>1/2</td>
</tr>
<tr>
<td>购买频率</td>
<td>6</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>购买商品种类</td>
<td>2</td>
<td>1/3</td>
<td>1</td>
</tr>
</tbody>
</table>
<h4 id="计算各指标权重"><a href="#计算各指标权重" class="headerlink" title="计算各指标权重"></a>计算各指标权重</h4><p>将判断矩阵的每一列进行归一化得出下方的矩阵：</p>
<table>
<thead>
<tr>
<th>1/9</th>
<th>1/9</th>
<th>1/9</th>
</tr>
</thead>
<tbody>
<tr>
<td>6/9</td>
<td>6/9</td>
<td>6/9</td>
</tr>
<tr>
<td>2/9</td>
<td>2/9</td>
<td>2/9</td>
</tr>
</tbody>
</table>
<p>对归一化后的矩阵的每一行进行求和运算：</p>
<table>
<thead>
<tr>
<th>3/9</th>
</tr>
</thead>
<tbody>
<tr>
<td>18/9</td>
</tr>
<tr>
<td>6/9</td>
</tr>
</tbody>
</table>
<p>将上述求和的得到的矩阵再次进行归一化得到矩阵w：</p>
<table>
<thead>
<tr>
<th>0.11</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.67</td>
</tr>
<tr>
<td>0.22</td>
</tr>
</tbody>
</table>
<p>该矩阵就表示了各指标的权重情况，最近购买间隔占比占比为0.11，购买频率占比0.64，购买商品种类占比0.24。</p>
<p>计算最大特征根:<br>在计算最大特征根我们需要先计算Aw值，Aw计算是将判断矩阵A与归一化得到的矩阵w相乘（公众号不支持公式，很烦），最后得到Aw值：</p>
<table>
<thead>
<tr>
<th>0.33</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.98</td>
</tr>
<tr>
<td>0.66</td>
</tr>
</tbody>
</table>
<p>再进行计算最大特征根：<code>1/3*(0.33/0.11+1.98/0.67+0.66/0.22)=3</code></p>
<h4 id="一致性检验"><a href="#一致性检验" class="headerlink" title="一致性检验"></a>一致性检验</h4><p>计算一致性指标CI:<code>(3-3)/(3-1)=0</code><br>根据指标数量n选择指标RI：这里n=3,所以RI=0.58</p>
<p>计算一致性比率CR=CI/RI=0&lt;0.1符合，所以用户忠诚度的各指标权重值w矩阵可用。</p>
<h4 id="层次单排序-1"><a href="#层次单排序-1" class="headerlink" title="层次单排序"></a>层次单排序</h4><p>因为总目标只拆解成了两个小问题，所以这里直接人为指定权重即可(用户忠诚度:用户消费能力=0.67:0.33)，不需要进行一致性检验。</p>
<p>用户忠诚度拆解的指标有三个，需要进行一致性检验，且经过检验后符合CR&lt;0.1的条件，所以用户忠诚度指标中各指标权重为：最近购买间隔占比占比为0.11，购买频率占比0.64，购买商品种类占比0.24。</p>
<p>用户消费能力拆解的指标也只有两个，直接人为指定权重即可。</p>
<h4 id="层次总排序"><a href="#层次总排序" class="headerlink" title="层次总排序"></a>层次总排序</h4><p>最后将各层次的权重相乘就是每个指标的权重占比。</p>
<table>
<thead>
<tr>
<th>指标</th>
<th>计算</th>
<th>最后权值</th>
</tr>
</thead>
<tbody>
<tr>
<td>最近购买间隔</td>
<td>0.67*0.11</td>
<td>0.07</td>
</tr>
<tr>
<td>购买频率</td>
<td>0.67*0.67</td>
<td>0.45</td>
</tr>
<tr>
<td>购买商品种类</td>
<td>0.67*0.22</td>
<td>0.15</td>
</tr>
<tr>
<td>平均每次消费额</td>
<td>0.33*0.67</td>
<td>0.22</td>
</tr>
<tr>
<td>单次最高消费额</td>
<td>0.33*0.33</td>
<td>0.11</td>
</tr>
</tbody>
</table>
<p><img src="https://ws1.sinaimg.cn/large/7602070dly1fqc9z991fzj20vl09t3yw.jpg" alt="image"></p>
<h4 id="进行评分"><a href="#进行评分" class="headerlink" title="进行评分"></a>进行评分</h4><p>最后将每个指标<strong>缩小到0-10的范围</strong>（不一定缩小到0-10，但是必须把每个指标缩小到相同大小范围内），然后乘各指标所占权重，最后相加，就是每个用户的总价值得分。</p>
<table>
<thead>
<tr>
<th>用户</th>
<th>最近购买间隔</th>
<th>购买频率</th>
<th>商品种类</th>
<th>平均每次消费额</th>
<th>单词最高消费额</th>
<th>价值得分</th>
</tr>
</thead>
<tbody>
<tr>
<td>用户A</td>
<td>3</td>
<td>5</td>
<td>2</td>
<td>5</td>
<td>9</td>
<td>4.85</td>
</tr>
<tr>
<td>用户B</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>5</td>
<td>3.50</td>
</tr>
</tbody>
</table>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://ws1.sinaimg.cn/large/7602070dly1fqcbzsq7j6j20qo0qoacs.jpg"
                alt="张俊红" />
            
              <p class="site-author-name" itemprop="name">张俊红</p>
              <p class="site-description motion-element" itemprop="description">一个挖矿工人到数据民工的成长历程</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/junhongzhang" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">张俊红</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
